import{e as o,g as e,c as t}from"../../../nitro/nitro.mjs";import{e as r,d as s}from"../../../_/session.mjs";import"node:events";import"node:buffer";import"node:process";import"cloudflare:workers";import"node:timers";import"node:util";import"node:crypto";import"../../../virtual/_commonjsHelpers.mjs";import"node:stream";const i=o(o=>{const i=e(o,"Authorization");if(void 0===i)throw t({statusCode:403,message:"Need to pass valid Bearer-authorization header to access this endpoint"});const n=r(i);let a;try{const o=s(n);if(!o)throw new Error("Expected decoded JwtPayload to be non-empty");a=o}catch(o){throw console.error({msg:"Login failed. Here's the raw error:",error:o}),t({statusCode:403,message:"You must be logged in to use this endpoint"})}const{sub:m,groups:d,name:p,exp:c,iss:u,jti:l}=a;return{sub:m,groups:d,name:p,exp:c,iss:u,jti:l}});export{i as default};
//# sourceMappingURL=user.get.mjs.map
